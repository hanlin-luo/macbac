## V1

<del>

帮助我编写一个用于 claude code 的 CLAUDE.md 文件。用于指导 claude code 帮助我开发一个名为 【mac-init】的应用程序。

1. 这个程序的主要功能是帮助我自动化初始化我的 macOS 系统的工作环境。
2. 这个项目使用 python 3.13 版本开发。
3. 这个程序需要尽可能覆盖我常用的应用程序和工具,这些软件包括：

   - 需要从 app store 下载安装的程序；
   - 需要从官方网站下载安装包手动安装的程序；
   - 需要通过 Homebrew 安装的程序；
   - 需要通过命令行安装的程序；
   - 以及其他需要你帮助我总结分类的程序；

4. 程序列表从哪里来？

   - 通过程序自动化查询 macOS 系统中已安装的应用程序；
   - 通过程序自动化查询 macOS 系统中已安装的 Homebrew 包
   - 通过程序自动化查询 macOS 系统中已安装的命令行工具；
   - 通过程序自动化查询 macOS 系统中已安装的其他软件；

5. 这个程序需要能够生成一个清单，列出所有已安装的应用程序和工具，并提供安装或更新的选项。
6. 这个程序需要能够自动化执行安装和更新操作，尽可能减少手动干预。
7. 这个程序需要提供一个用户友好的界面，但功能不能过于复杂，因为程序安装和配置可能非常复杂。
8. 开发环境的另一个重要因素是环境配置，包括系统环境变量，已安装的应用程序的配置等等。这些配置要求能够进行自动化配置，配置的来源需要这个【mac-init】程序自动化查询和生成。

deprecated：（因为 mac 生态下的应用程序无法穷举，所以需要使用 AI 进行分类分析需要配合 web search 实现？）

</del>

## V2

我需要开发一个软件，请为我编写这个软件的更为详细的 software design document。

## 简要概述

1. 这个软件的名称是 macrate (means: MacOS Migration)。
2. 这个软件的最核心功能是将现有的旧的 mac 系统上的应用程序和配置迁移到新的 mac 系统上。旨在简化新设备的设置过程，确保用户能够快速恢复到熟悉的工作环境。
3. 这个软件支持不同系统版本之间的迁移，能够处理 macOS 的不同版本和配置差异。

## 功能需求

这个软件需要支持以下功能：

1. 这个软件需要一个可视化界面，并提供可靠的引导功能，分别实现旧设备的备份和新设备的恢复。
2. 备份功能：
   - 扫描当前系统，备份所有已安装的应用程序和工具清单。
   - 备份时需要进行分类，分类方法如下：
     1. App Store 和沙盒化应用程序 - 备份应用列表和恢复时必要的信息，无需备份应用数据。
     2. 包管理软件生态系统 - 通过 Homebrew Brewfile 备份，无需备份包数据。
     3. 开发环境和工具链 - 备份开发工具列表，开发配置等，需要备份配置文件。
     4. 字体管理 - 备份用户的自定义字体
     5. 手动安装应用程序 - 备份应用列表
3. 恢复功能：
   - 从备份数据中引导用户开始恢复过程；
   - 根据应用程序和工具的分类，分别完成：
     1. App Store 和沙盒化应用程序 - 通过 mas-cli 恢复
     2. 包管理软件生态系统 - 通过 Homebrew Brewfile 恢复
     3. 开发环境和工具链 - 恢复开发工具列表，开发配置等
     4. 字体管理 - 恢复用户的自定义字体
     5. 手动安装应用程序 - 提供手动安装的指导和链接

## 技术栈要求

## V3 简化版

我需要开发一个软件，请为我编写这个软件的更为详细的 software design document。

## 简要概述

1. 这个软件的名称是 macbac (means: MacOS Backup and Migration)。
2. 这个软件的最核心功能是：将现有的旧的 mac 系统上的应用程序和配置迁移到新的 mac 系统上。旨在简化新设备的设置过程，确保用户能够快速恢复到熟悉的工作环境。

## 功能需求

这个软件需要支持以下功能：

1. 这个软件需要一个简单的命令行启动命令，运行后开始旧系统备份。暂时不考虑恢复功能。
2. 备份功能：
   - 扫描当前系统，备份所有已安装的应用程序和工具清单。
   - 备份时需要进行分类，分类方法如下：
     1. App Store 和沙盒化应用程序 - 备份应用列表和恢复时必要的信息，无需备份应用数据。
     2. 包管理软件生态系统 - 通过 Homebrew Brewfile 备份，无需备份包数据。
     3. 开发环境和工具链 - 备份开发工具列表，开发配置等，需要备份配置文件。
     4. 字体管理 - 备份用户的自定义字体
     5. 手动安装应用程序 - 备份应用列表
3. 备份数据存储
   - 备份数据需要存储在用户指定的目录中，默认存储在用户的主目录下的 `macbac_backups` 文件夹中。
   - 备份数据需要包含一个时间戳，以便用户区分不同的备份版本。
   - 备份数据需要包含一个清单文件，列出所有已备份的应用程序和工具，文件格式要易于阅读，使用 markdown 格式以及 markdown table。

## 技术栈要求

- 使用 python 3.13 版本开发。
- 使用 click 库来实现命令行界面。
- 使用 rich 库来实现美观的终端输出。
- 包管理和项目管理使用 uv，使用 pyproject.toml 文件管理依赖。
- 使用 ruff 进行代码风格检查。
- 使用 mypy 进行类型检查。
- 使用 pytest 进行单元测试。

## v4

请帮助我在 spec-v3.md 的基础上，编写新的 spec-v4.md 文件。

### 删除功能

1. 删除备份功能中的【3. 开发环境和工具链 - 备份开发工具列表，开发配置等，需要备份配置文件。】
   - 因为开发环境和工具链的配置文件比较多，备份起来比较麻烦，所以决定不备份开发环境和工具链的配置文件。
   - 但是需要备份开发环境和工具链的安装列表，因为用户可能会根据需要安装不同的开发环境和工具链。

### 改进功能

1. 优化备份数据的存储结构：
   - 现有生成的 markdown 格式文件继续保留，作为备份报告最后输出即可。
   - 为了恢复功能，请选择合适的存储方式进行备份数据的存储，考虑到备份数据的大小和恢复速度。

### 新增功能

1. 新增恢复功能
   - 从备份数据中引导用户开始恢复过程，不同类型的恢复使用不同的恢复命令参数，用户可以根据提示进行操作；
   - 根据应用程序和工具的分类，分别完成：
     1. App Store 和沙盒化应用程序 - 通过 mas-cli 恢复
     2. 包管理软件生态系统 - 通过 Homebrew Brewfile 恢复
     3. 字体管理 - 恢复用户的自定义字体
